# 第十章 正则表达式的模式匹配

## 概念

* 描述字符模式的对象
* RegExp表示正则表达式，通过正则表达式进行强大的模式匹配和文本检测与替换功能
* String也定义了方法

## 1、正则表达式的定义

* 概念：
  * RegExp（）也是一个构造函数，更多时候选择通过特殊的直接量语法来创建正则RegExp对象
  * 正则表达式的直接量是通过（/）包围的字符
  * RegExp直接量和对象的创建：
    * 正则表达式直接量与常规对象直接量不同，ECMAScript3中直接量执行结束转换为一个RegExp对象，每次执行同一段代码返回同一个对象，而ECMAScript5中返回新对象
  * 由字符序列组成

* 1、直接量字符：

  * 正则表达式中所有的字母和数字都是按照字面含义匹配的
  * 也支持非字母的字符匹配，通过反斜线（\）的组合
  * 如果不记得那些标点符号需要反斜线，可以在全部标点符号前边添加反斜线
  * 尽量不要对想要直接进行匹配的字母和数字进行反斜线转义；想要匹配反斜线本身，必须使用反斜线转义

* 2、字符类：

  * 直接量字符单独放进方括号内，组成了字符类

    ``` javascript
    [...]//括号内的任意字符
    [^...]//不在括号内的任意字符
    ```

    

  * 方括号内也可以使用特殊转义字符

* 3、重复：

  * 可以描述特定多位数，但是却不能描述任意多位数

    ``` javascript
    {n,m}//匹配前一项n至m次
    {n,}//匹配前一项n至更多
    {n}//匹配前一项n次
    ?//匹配前一项0或1次
    +//匹配1次或更多次
    *//匹配0次或更多
    ```

    

  * 非贪婪的重复：

    * 在待匹配字符后跟随一个问号，尽可能少的匹配，减少不必要的匹配次数

* 4、选择，分组和引用

  * | ，选择项的匹配次序是从左到右，找到匹配项就停止
  * （....），通过圆括号将单独的项组合成一个独立单元来处理
  * 圆括号的另一个作用是允许后部引用前面的子表达式，通过在字符“\”后多加一位或者多位数字实现，这些数字指代子表达式在表达式中所处的位置
  * （?:...）不用创建带数字编码的引用，也可以对子表达式进行分组。通过“（？：”和“）”来进行分组，可以应用到各个分组，但是并不生成引用
  * \n，和第n个分组第一次字符相匹配

* 5、指定匹配位置：

  * \s匹配空白符，\b匹配单词边界
  * （?=p）零宽正向先行断言，指定一个匹配位置，要求接下来的字符都与p匹配
  * （?!p）零宽负向先行断言，要求接下来的字符都不与p匹配

* 6、修饰符：

  * 修饰符是放在“/”之外的，第二条斜线之后
  * g代表全局，i代表不区分大小写，m用在多行匹配

## 2、用于模式匹配的String方法

* 共有4种匹配方法
* 1、最简单的search（），参数是正则表达式
* 2、replace（）同时做到检索和替换，参数有两个，前者检索，后者替换检索的位置。还可以通过“$“+数字的形式引用子表达式
* 3、match（）是最常用的，唯一参数是正则表达式，返回一个由匹配结果组成的数组
* 4、split（）的参数也可以是正则表达式

## 3、RegExp对象

* 概念：除了构造函数，还支持三个方法和一些属性
* 1、RegExp的属性：
  * 包含五个属性：
    * source，只读的字符串，包含正则表达式的文本
    * global，只读的布尔值，代表是否带有修饰符g
    * ignoreCase，只读的布尔值，代表是否带有修饰符i
    * multiline，只读的布尔值，代表是否带有修饰符m
    * lastIndex，可读写的整数，如果匹配模式带有g修饰符，这个属性存储在整改字符串下一次检索开始的位置，属性可以被exec（）和test（）用到
* 2、RegExp的方法：
  * exec（），主要执行模式匹配的方法，和match（）相似，但是参数是RegExp对象，返回的也是一个数组，属性index代表发生匹配的位置，属性input引用的是正在检索的字符串。不论正则表达式是否具有g修饰符，都会返回一样的数组结果，当同一个正则表达式第二次调用exec（）就会从上一次的lastIndex继续检索，如果没找到就重置为0
  * test（），参数是字符串，对某个字符串进行检测，包含正则表达式的结果，就返回true。调用exec和调用test等价，当exec返回结果不是null时，test返回true。当一个全局正则表达式调用test时，它的行为和exec一样，如果找到匹配结果，都会立刻修改lastIndex
  * String方法不会调用lastIndex，只是将它重置为0，使用exec和test要特别注意lastIndex的值，当然，如果RegExp不带有修饰符g就不用担心
  * ECMAScript5中，每次计算正则表达式都会重新生成一个RegExp对象，所以大大减少了lastIndex残留所带来的影响

