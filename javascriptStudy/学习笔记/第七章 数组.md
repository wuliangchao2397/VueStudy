# 第七章 数组

## 概念

* 值的有序集合
* JavaScript数组是无类型的，数组元素可以是任何类型
* 继承自Array.prototype中的属性

## 1、创建数组

* 使用数组直接量创建数组，其中的值不一定是常量，也可以是任意表达式，可以包含对象直接量

* 构造函数Array（）是创建数组的另一个方法，共三种格式：

  ``` javascript
  var a = new Array();//不含参
  var a = new Array(10);//指定长度
  var a = new Array(5,4,3,2,1,"testing,testing");//指定两个或多个数组元素
  ```

  

## 2、数组元素的读和写

* 通过[]操作符来访问数组中的一个元素，数组的引用位在括号左侧，括号内部是返回非负整数值的任意表达式
* 数组是对象的特殊形式，使用方括号访问数组元素就像方括号访问对象的属性一样，只是数组的索引值固定为有序的非负整数
* 数组的特别之处在于，当使用小于2^32的非负整数作为属性名时数组会自动维护其length的值
* 如果输入负数，因为不是非负整数，负数会被当做普通对象的属性名看待，或查找或创建
* 可以从原型中继承元素，可以定义元素的setter和getter方法

## 3、稀疏数组

* 包含从0开始的不连续索引的数组，稀疏数组的length大于元素的个数
* 创建稀疏数组：
  * 通过Array（）设定索引值大于当前的数组长度，但估计和环境有关，不管直接量还是Array（）方法直接创造出来的都是无元素，并不能通过in来找未赋值的属性名
  * 直接设定空数组
  * 赋值添加一个大于1的数，形成长度length大于元素个数
  * delete操作符来产生稀疏数组
* 稀疏数组在实现上比稠密数组更慢，内存利用效率更高，在这样的数组查找元素的时间与常规对象属性的查找时间一样长
* 数组直接量中，省略值不会创建稀疏数组，为undefined，和数组元素根本不存在并不一样

## 4、数组长度

* 每个数组都有一个length属性，针对非稀疏数组，length就是数组中元素的个数，其值比最大索引大1
* length的变化如果小于了元素个数，会自动删除数组元素

## 5、数组元素的添加和删除

* 添加数组元素可以通过索引赋值，可以通过push（）推入，push（）可以推入单个也可以推入多个
* 删除元素可以和对象一样通过delete删除
* pop（）方法可以删除尾部的元素，同时返回被删除的元素的值。
* shift（）从数组头部删除一个元素，同时将所有元素下移到比当前索引低1的地方

## 6、数组遍历

* for循环遍历，值得注意的是，并非所有元素都是合法数据，如果需要，可使用非空的条件语句跳过null，跳过undefined用恒等判断比较保险，仅仅只是处理不存在的元素的话可以用in来区别
* for/in循环，处理稀疏数组会自动略过不存在的索引。允许以不同的顺序遍历属性，但如果算法对遍历有依赖，最好还是使用for
* forEach（）方法，可以遍历每个元素，并传递给内部函数

## 7、多维数组

* 并不是支持真正的多维数组，只是做了近似效果
* 访问时很简单，两次[]分别表示行与列。创建时需要先创建一组数组对象，对这个对象数组再通过for循环依次对每一个元素进行一次数组对象创建操作，赋予每个元素数组。本质其实就是对象嵌套模拟多维数组。

## 8、数组方法

* 任何数组通用

* 1、join（）

  将所有元素转换为字符串并连接到一起，返回生成的字符串，是split（）的逆向操作。参数作为分隔符。

* 2、reverse（）

  颠倒顺序

* 3、sort（）

  * 排序后返回，undefined元素会被放到最后
  * 必须传给sort函数一个比较函数

* 4、concat（）

  * 创建并返回一个新数组，其元素包含原始数组的元素和concat（）的参数

* 5、slice（）

  * 返回指定数组的一个片段或者子数组，两个数字代表开始和结束的位置

* 6、splice（）

  * 在数组中插入或删除元素的通用方法，会修改调用的数组
  * 第一个参数代表开始删除的起点，第二个参数代表要删除的元素个数，如果第二个不填，就会一直删除到数组尾部，第三个参数开始代表要插入的元素，可以是多个

* 7、push（）和pop（）

  * 将数组视为栈结构的用法

* 8、unshift（）和shift（）

  * 类似于栈，只是执行的位置在头部，类似头插法，同时会改变后续一直到数组尾部的索引值

* 9、toString（）和toLocalString（）

  * toString（）把每个元素转换成字符串，不包含任何形式包裹的方括号，与不使用任何参数的join（）相似
  * toLocalString（）使用本地化分隔符将字符串连接起来

## 9、ECMAScript5中的数组方法

* forEach（）
  * 为每个元素调用指定的函数
  * 无法在所有元素都传递给调用的函数之前终止遍历
* map（）
  * 和forEach（）调用方式一样，但是它生成新数组
* filter（）
  * 返回的数组元素是调用的数组的一个子集，构成子集的是返回值为true或者能转化为true的元素
  * 调用判定与forEach（）和map（）一样
  * 会跳过稀疏数组中缺少的元素
  * 也可以用于压缩数组，过滤指定条件的元素
* every（）和some（）
  * 数组的逻辑判定
  * every（）含义对应的是数学中的所有
  * some（）的含义对应的是数学中的存在
  * 这两个条件是对立的
* reduce（）和reduceRight（）
  * 将数组元素进行组合，生成单个值
  * reduce（）需要两个参数，第一个是将对全部元素执行简化的函数，第二个是设置给左侧操作数的初始值。特点在于每次计算的值会累积往下计算
  * reduceRight（）和reduce（）一样，但是是根据索引值从高到低（从右到左）处理的
  * union在与这两者配合运用时，遇到重名属性，reduce会以左侧开始第一个参数为准，reduceRight以右侧开始
* indexOf（）和lastIndexOf（）
  * 找指定值的元素，indexOf（）找第一个，lastIndexOf（）找最后一个
  * 第一个参数是要搜索的值，第二个参数代表起点，不给第二个参数就是从头开始

## 10、数组类型

* Array.isArray（）可以用于判断给定的对象是否是数组
* typeof在分辨数组这里无法起作用
* instanceof问题在于，web浏览器可能开启多个窗口或者窗体，每个窗口都有自己的环境和全局变量，因此一个窗体中的对象就不可能会是另一个窗体中构造函数的实例

## 11、类数组对象

* 数组的一些特性是其他对象没有的：
  * 当有新的元素添加到列表当中时，自动更新length
  * 设置length为一个较小值时，将截断数组
  * 从Array.prototype中继承一些方法
  * 类属性为“Array”
* 数组方法不仅能在数组上使用，也可以在类数组上正常运作
* 类数组没有继承自Array.prototype，不能在它上边直接调用数组方法

## 12、作为数组的字符串

* 这种字符串，行为类似于只读的数组。
* 访问可以用charAt（）和方括号
* typeof返回的是string，Array.isArray（）返回的是false
* 注意：字符串是不可变值，所以才会是只读，所以push（），sort（），reverse（），splice（）都是无效的

